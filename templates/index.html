<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrossDaun Dashboard</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">

    <style>
        body {
            background-color: #0f111a;
            color: #e1e1e6;
            padding: 20px;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        .main-card {
            background: #1a1d29;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.5);
            border: 1px solid #2d2f3f;
        }

        h2 { color: #8257e5; font-weight: 700; margin-bottom: 25px; }

        /* –¢–∞–±–ª–∏—Ü–∞ */
        .table { color: #e1e1e6 !important; margin-top: 10px !important; }
        .table-hover tbody tr:hover { background-color: rgba(130, 87, 229, 0.08) !important; }

        /* –ê–≤–∞—Ç–∞—Ä–∫–∏ –∏ —Å—Å—ã–ª–∫–∏ */
        .avatar-img { border: 2px solid #8257e5; object-fit: cover; background: #242737; }
        .user-link { color: #00d4ff; text-decoration: none; font-weight: 600; transition: 0.2s; }
        .user-link:hover { color: #8257e5; text-decoration: underline; }

        /* –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –ø—Ä–∏–∂–∏–º–∞–µ–º –∫–Ω–æ–ø–∫–∏ –∫ —Ç–µ–∫—Å—Ç—É */
        table.dataTable thead th {
            position: relative;
            background-image: none !important; /* –£–±–∏—Ä–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏–∫–æ–Ω–∫–∏-—Ñ–æ–Ω—ã */
            white-space: nowrap;
            padding-right: 25px !important;
        }

        /* –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç—Ä–µ–ª–æ—á–∫–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤–ø–ª–æ—Ç–Ω—É—é –∫ –±—É–∫–≤–∞–º */
        table.dataTable thead .sorting::after,
        table.dataTable thead .sorting_asc::after,
        table.dataTable thead .sorting_desc::after {
            position: absolute !important;
            right: 8px !important;
            display: block !important;
            font-family: serif !important;
            opacity: 0.5;
        }
        table.dataTable thead .sorting_asc::after { content: "‚ñ≤" !important; opacity: 1; color: #8257e5; }
        table.dataTable thead .sorting_desc::after { content: "‚ñº" !important; opacity: 1; color: #8257e5; }
        table.dataTable thead .sorting::after { content: "‚áÖ" !important; font-size: 0.8em; }

        /* –ü–æ–∏—Å–∫ */
        .dataTables_filter input {
            background: #242737 !important;
            border: 1px solid #444 !important;
            color: white !important;
            border-radius: 8px !important;
            padding: 5px 15px !important;
        }

        /* –°–∫—Ä—ã–≤–∞–µ–º –ª–∏—à–Ω–µ–µ */
        .dataTables_length, .dataTables_info { display: none !important; }
    </style>
</head>
<body>

<div class="container-fluid main-card">
    <h2>üìä –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h2>

    <table id="statsTable" class="table table-hover align-middle">
        <thead>
            <tr>
                <th>ID</th>
                <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                <th>Telegram ID</th>
                <th>üí¨ –°–æ–æ–±—â.</th>
                <th>üì∏ –§–æ—Ç–æ</th>
                <th>üé• –í–∏–¥–µ–æ</th>
                <th>üé≠ –°—Ç–∏–∫–∏</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr>
                <td><small class="text-muted">{{ user.id }}</small></td>
                <td>
                    <div class="d-flex align-items-center">
                        <img src="{{ user.avatar }}" class="avatar-img rounded-circle me-2" width="35" height="35" onerror="this.src='https://ui-avatars.com/api/?name=?&background=random'">
                        <a href="{{ user.profile_url }}" target="_blank" class="user-link">
                            {{ user.username_plain }}
                        </a>
                    </div>
                </td>
                <td><code class="text-secondary">{{ user.tg_id }}</code></td>

                <td data-order="{{ user.msg_count or 0 }}">{{ user.msg_count or 0 }}</td>
                <td data-order="{{ user.photo_count or 0 }}">{{ user.photo_count or 0 }}</td>
                <td data-order="{{ user.video_count or 0 }}">{{ user.video_count or 0 }}</td>
                <td data-order="{{ user.sticker_count or 0 }}">{{ user.sticker_count or 0 }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

<script>
    $(document).ready(function() {
        $('#statsTable').DataTable({
            "paging": false,
            "order": [[ 3, "desc" ]], // –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Å–æ–æ–±—â–µ–Ω–∏—è–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            "language": {
                "search": "–ü–æ–∏—Å–∫ –ø–æ –Ω–∏–∫—É/ID:",
                "zeroRecords": "–ù–∏–∫–æ–≥–æ –Ω–µ –Ω–∞—à–ª–∏ :("
            },
            "columnDefs": [
                { "type": "num", "targets": [3, 4, 5, 6] } // –£–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ —ç—Ç–æ —á–∏—Å–ª–∞
            ]
        });
    });
</script>

</body>
</html>